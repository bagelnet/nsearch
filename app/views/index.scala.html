
@*
 * This template takes a single argument, a String containing a
 * message to display.
 *@
@(message: String, totalCount: Int, result: List[Video])

@import org.joda.time.format._
@import org.joda.time.DateTime

@dateFormat(video: Video) = @{
    DateTimeFormat.forPattern("yyyy/MM/dd HH:mm").print(DateTimeFormat.forPattern("yyyy-MM-dd'T'HH:mm:ssZ").parseDateTime(video.startTime))
}

@countFormat(count: Int) = @{
    count match {
        case c if c < 1000 => <span class="counter">{s"${c}"}</span>
        case c if c < 1000000 => <span class="counter count-k">{f"${c/1000}%3d k"}</span>
        case c if c < 1000000000 => <span class="counter count-m">{f"${c/1000000}%3d m"}</span>
        case _ => <span class="counter count-0">{"many"}</span>

    }
}

@getDateFilterValue(beforeDay: Int) = @{
    new DateTime().minusDays(beforeDay).toString("yyyy-MM-dd'T'HH")
}

<!DOCTYPE html>
<html lang="en">
    <head>
        @* Here's where we render the page title `String`. *@
        <title>N-Search - Nicovideo Search</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/search.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.versioned("images/favicon.png")">
        <script src="@routes.Assets.versioned("javascripts/hello.js")" type="text/javascript"></script>
    </head>
    <body>
        <div class="row">
            <div class="col-md-2 sidebar">
                <div class="options">
                    <fieldset>
                        <legend>検索対象</legend>
                        <div class="checkbox"><label><input type="checkbox" name="t[]" value="title" form="main-form" checked>タイトル</label></div>
                        <div class="checkbox"><label><input type="checkbox" name="t[]" value="description" form="main-form" checked>説明文</label></div>
                        <div class="checkbox"><label><input type="checkbox" name="t[]" value="tags" form="main-form" checked>タグ(部分一致)</label></div>
                        <div class="checkbox"><label><input type="checkbox" name="t[]" value="tagsExact" form="main-form">タグ(完全一致)</label></div>
                    </fieldset>
                    <fieldset>
                        <legend>ソート</legend>
                        <div class="radio"><label><input type="radio" name="s" value="dp" form="main-form" checked>再生数が多い</label></div>
                        <div class="radio"><label><input type="radio" name="s" value="dr" form="main-form">投稿日が新しい</label></div>
                        <div class="radio"><label><input type="radio" name="s" value="dm" form="main-form">マイリストが多い</label></div>
                    </fieldset>
                    <fieldset>
                        <legend>投稿日時</legend>
                        <div class="radio"><label><input type="radio" name="r" value="@getDateFilterValue(1)" form="main-form">前日</label></div>
                        <div class="radio"><label><input type="radio" name="r" value="@getDateFilterValue(7)" form="main-form">先週</label></div>
                        <div class="radio"><label><input type="radio" name="r" value="@getDateFilterValue(30)" form="main-form" checked> 先月 </label></div>
                    </fieldset>
                    <fieldset>
                        <legend>再生時間1</legend>
                        <div class="radio"><label><input type="radio" name="p1" value="100" form="main-form" checked>指定なし</label></div>
                        <div class="radio"><label><input type="radio" name="p1" value="5" form="main-form">5分以内</label></div>
                        <div class="radio"><label><input type="radio" name="p1" value="10" form="main-form">10分以内</label></div>
                    </fieldset>
                    <fieldset>
                        <legend>再生時間2</legend>
                        <div class="radio"><label><input type="radio" name="p2" value="0" form="main-form" checked>指定なし</label></div>
                        <div class="radio"><label><input type="radio" name="p2" value="5" form="main-form">5分以上</label></div>
                        <div class="radio"><label><input type="radio" name="p2" value="20" form="main-form">20分以上</label></div>
                    </fieldset>
                </div>
            </div>
            <div class="col-md-10 col-md-offset-2 col-sm-offset-2 col-xs-offset-2 main">
                <div class="search-form alert alert-info">
                    @helper.form( action = routes.SearchController.index(), 'id -> "main-form" ) {
                        <div class="input-group search-box">
                            <input type="search" class="form-control" name="q" value="@message">
                            <span class="input-group-addon">@totalCount Hits</span>
                            <span class="input-group-btn">
                                <button class="btn btn-primary" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
                            </span>
                        </div>
                    }
                </div>
                <div class="result-box">
                @for(video <- result) {
                    <div class="col-md-3">
                        <div class="thumbnail">
                            <p class="start-time"> @dateFormat(video) </p>
                            <img src="@video.thumbnailUrl" alt="thumbnail" class="img-responsive">
                            <div class="caption">
                                <p class="video-info vcounter"><span class="glyphicon glyphicon-play" aria-hidden="true"></span> @countFormat(video.viewCounter) </p>
                                <p class="video-info mcounter"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> @countFormat(video.mylistCounter) </p>
                                <p class="video-info ccounter"><span class="glyphicon glyphicon-copyright-mark" aria-hidden="true"></span> @countFormat(video.commentCounter) </p>
                            </div>
                            <div class="video-title">
                                <p><a href="http://www.nicovideo.jp/watch/@video.contentId" title="@video.title">@video.title</a></p>
                            </div>
                        </div>
                    </div>
                }
                </div>
            </div>
        </div>
    </body>
</html>

